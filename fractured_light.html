<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fractured Light</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a0b2e 0%, #2d0b3e 100%);
            color: #e6e6e6;
            min-height: 100vh;
            padding: 20px 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1350px;
            width: 100%;
            background: rgba(25, 15, 45, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
            padding: 30px;
            margin-top: 20px;
            position: relative;
            overflow: hidden;
            border: 1px solid #5a4a8a;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #5a4a8a;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            background: linear-gradient(45deg, #ff6b6b, #9b5cff, #6b8cff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 10px rgba(155, 92, 255, 0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #c0a0e0;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .game-area {
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            position: relative;
        }
        
        .scene {
            background: linear-gradient(135deg, #512d82, #3b226c);
            border-radius: 20px;
            padding: 30px;
            border: 2px solid #9b5cff;
            box-shadow: 0 10px 25px rgba(0,0,0,0.4);
            margin-bottom: 30px;
            position: relative;
            z-index: 5;
        }
        
        .scene-text {
            font-size: 1.1rem;
            color: #f0e9ff;
            line-height: 1.8;
            margin-bottom: 25px;
        }
        
        .scene-text .character {
            color: #ff8e8e;
            font-weight: bold;
        }
        
        .scene-text .player {
            color: #6bffb8;
            font-weight: bold;
        }
        
        /* Choices look like full-width pill bars */
        .choices {
            display: flex;
            flex-direction: column;
            gap: 18px;
            margin-top: 20px;
        }
        
        .choice-btn {
            width: 100%;
            background: #3d2d5f;
            border: 2px solid #5a4a8a;
            color: #e6e6e6;
            padding: 18px 25px;
            font-size: 1rem;
            text-align: center;
            border-radius: 40px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(155, 92, 255, 0.2);
        }
        
        .choice-btn:hover {
            background: #5a4791;
            transform: translateY(-2px);
            border-color: #9b5cff;
            box-shadow: 0 6px 20px rgba(155, 92, 255, 0.4);
        }
        
        .choice-btn:active {
            transform: translateY(1px);
        }
        
        .choice-btn i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }
        
        /* Top-right stat pills */
        .stats {
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
            background: #240e3e;
            padding: 15px 20px;
            border-radius: 40px;
            border: 2px solid #9b5cff;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            font-size: 0.95rem;
            color: #fff;
            margin: 0 auto 30px;
            max-width: 700px;
            justify-content: center;
        }
        
        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 120px;
        }
        
        .stat-value {
            font-size: 1.4rem;
            font-weight: bold;
            color: #9b5cff;
        }
        
        .stat-meter {
            width: 100%;
            height: 8px;
            background: rgba(70, 60, 100, 0.5);
            border-radius: 4px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .stat-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b, #9b5cff);
            border-radius: 4px;
        }
        
        .ending-screen {
            text-align: center;
            padding: 30px;
            animation: fadeIn 1s ease;
            background: linear-gradient(135deg, #512d82, #3b226c);
            border-radius: 20px;
            border: 2px solid #9b5cff;
            box-shadow: 0 10px 25px rgba(0,0,0,0.4);
        }
        
        .ending-title {
            font-size: 2.2rem;
            color: #9b5cff;
            margin-bottom: 25px;
            text-shadow: 0 0 15px rgba(155, 92, 255, 0.5);
        }
        
        .ending-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            color: #6b8cff;
        }
        
        .ending-description {
            font-size: 1.15rem;
            line-height: 1.8;
            margin-bottom: 30px;
            background: rgba(50, 40, 80, 0.6);
            padding: 25px;
            border-radius: 10px;
            border-left: 4px solid #9b5cff;
            text-align: left;
        }
        
        .ending-tag {
            display: inline-block;
            background: rgba(155, 92, 255, 0.2);
            padding: 5px 15px;
            border-radius: 20px;
            margin-top: 10px;
            font-size: 0.9rem;
            border: 1px solid #9b5cff;
        }
        
        .restart-btn {
            background: linear-gradient(45deg, #9b5cff, #6b8cff);
            border: none;
            border-radius: 8px;
            padding: 15px 40px;
            color: white;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(155, 92, 255, 0.4);
            margin-top: 20px;
        }
        
        .restart-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(155, 92, 255, 0.6);
        }
        
        .resources {
            margin-top: 40px;
            padding: 25px;
            background: rgba(40, 30, 70, 0.7);
            border-radius: 10px;
            border-top: 3px solid #9b5cff;
        }
        
        .resources h2 {
            color: #9b5cff;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .resource-list {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        .resource-item {
            background: rgba(50, 40, 90, 0.6);
            padding: 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
            display: flex;
            align-items: flex-start;
        }
        
        .resource-item:hover {
            background: rgba(60, 50, 100, 0.8);
            transform: translateX(5px);
        }
        
        .resource-icon {
            font-size: 1.5rem;
            color: #9b5cff;
            margin-right: 15px;
            min-width: 30px;
        }
        
        .resource-content h3 {
            color: #9b5cff;
            margin-bottom: 5px;
        }
        
        .resource-content p {
            font-size: 0.95rem;
            color: #d0c0f0;
        }
        
        .progress-container {
            width: 100%;
            height: 8px;
            background: rgba(70, 60, 100, 0.5);
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b, #9b5cff, #6b8cff);
            border-radius: 4px;
            width: 0%;
            transition: width 0.5s ease;
        }

        a:link {
            color: rgb(183, 87, 255);
            background-color: transparent;
            text-decoration: none;
        }

        a:visited {
            color: rgb(200, 120, 255);
            background-color: transparent;
            text-decoration: none;
        }

        a:hover {
            color: rgb(212, 106, 252);
            background-color: transparent;
            text-decoration: underline;
        }

        a:active {
            color: rgb(235, 135, 255);
            background-color: transparent;
            text-decoration: underline;
        }
        
        .pride-flag {
            position: absolute;
            width: 30px;
            height: 100px;
            top: 0;
            opacity: 0.1;
            z-index: 0;
            animation: float 20s linear infinite;
        }
        
        .pride-flag::before,
        .pride-flag::after {
            content: "";
            position: absolute;
            width: 100%;
            height: 20%;
            left: 0;
        }
        
        @keyframes float {
            0% { transform: translate(0, 0) rotate(0deg); opacity: 0.7; }
            50% { transform: translate(20px, -20px) rotate(10deg); opacity: 0.4; }
            100% { transform: translate(0, 0) rotate(0deg); opacity: 0.7; }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .scene {
                padding: 20px;
            }
            
            .stats {
                flex-direction: column;
                gap: 15px;
                width: 100%;
            }
            
            .stat-item {
                width: 100%;
                align-items: flex-start;
            }
            
            .choice-btn {
                padding: 15px;
                font-size: 0.95rem;
            }
            
            .scene-text {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Fractured Light</h1>
            <p class="subtitle">An interactive experience exploring toxic relationship patterns in LGBTQIA+ relationships. Your choices will shape Han's journey.</p>
        </header>
        
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        
        <div class="stats">
            <div class="stat-item">
                <span>Self-Worth</span>
                <div class="stat-value" id="worthStat">50%</div>
                <div class="stat-meter"><div class="stat-fill" id="worthFill" style="width: 50%"></div></div>
            </div>
            <div class="stat-item">
                <span>Community</span>
                <div class="stat-value" id="communityStat">70%</div>
                <div class="stat-meter"><div class="stat-fill" id="communityFill" style="width: 70%"></div></div>
            </div>
            <div class="stat-item">
                <span>Safety</span>
                <div class="stat-value" id="safetyStat">60%</div>
                <div class="stat-meter"><div class="stat-fill" id="safetyFill" style="width: 60%"></div></div>
            </div>
        </div>
        
        <div class="game-area" id="gameArea">
            <!-- Game content will be dynamically rendered here -->
        </div>
        
        <div class="resources">
            <h2><i class="fas fa-rainbow"></i> LGBTQIA+ Resources & Support</h2>
            <div class="resource-list">
                <div class="resource-item">
                    <div class="resource-icon"><i class="fas fa-phone-alt"></i></div>
                    <div class="resource-content">
                        <h3>The Trevor Project</h3>
                        <p>Call 1-866-488-7386 or text START to 678678</p>
                    </div>
                </div>
                <div class="resource-item">
                    <div class="resource-icon"><i class="fas fa-globe"></i></div>
                    <div class="resource-content">
                        <h3>LGBT National Help Center</h3>
                        <p>Youth Talkline: 1-800-246-7743<br>
                        <a href="https://www.lgbthotline.org/">lgbthotline.org</a></p>
                    </div>
                </div>
                <div class="resource-item">
                    <div class="resource-icon"><i class="fas fa-hands-helping"></i></div>
                    <div class="resource-content">
                        <h3>Trans Lifeline</h3>
                        <p>1-877-565-8860 (US)<br>
                        1-877-330-6366 (Canada)</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <footer>
        <p>This interactive experience explores toxic relationship patterns in LGBTQIA+ relationships. If you're in an unhealthy relationship, please reach out to the resources above.</p>
    </footer>

    <script>
        // Game state
        const gameState = {
            currentScene: 'start',
            selfWorth: 50,
            community: 70,
            safety: 60,
            progress: 0,
            endings: [],
            identityQuestioned: false,
            isolated: false
        };
        
        // Update stats display
        function updateStats() {
            document.getElementById('worthStat').textContent = `${gameState.selfWorth}%`;
            document.getElementById('communityStat').textContent = `${gameState.community}%`;
            document.getElementById('safetyStat').textContent = `${gameState.safety}%`;
            
            document.getElementById('worthFill').style.width = `${gameState.selfWorth}%`;
            document.getElementById('communityFill').style.width = `${gameState.community}%`;
            document.getElementById('safetyFill').style.width = `${gameState.safety}%`;
            
            document.getElementById('progressBar').style.width = `${gameState.progress}%`;
        }
        
        // Scene definitions
        const scenes = {
            start: {
                text: `<p>You're <span class="player">Han</span>, a non-binary teen (they/them) dating <span class="character">Jordan</span> (she/her) for six months. At first, Jordan was incredibly supportive of your identity, but lately she's been making subtle comments like: "Are you sure you're not just confused?" and "Maybe you'd feel better if you presented more feminine."</p>
                       <p>Tonight at your LGBTQIA+ youth group meeting, Jordan rolled her eyes when you shared your pronouns. Afterward, she said: "Why do you have to make everything about your identity? It's embarrassing."</p>
                       <p>Your friend <span class="character">Riley</span> texts you: "Hey, Jordan seemed off tonight. Everything okay?"</p>`,
                choices: [
                    { text: '"Everything\'s fine" (Dismiss Riley\'s concern)', next: 'dismiss', effect: { selfWorth: -10, community: -15, safety: 0 }, icon: "fas fa-comment-slash" },
                    { text: '"Not really... Jordan\'s been weird about my identity"', next: 'confide', effect: { selfWorth: 0, community: 10, safety: 5 }, icon: "fas fa-user-friends" },
                    { text: 'Confront Jordan about her comments', next: 'confront', effect: { selfWorth: 5, community: 0, safety: -5 }, icon: "fas fa-exclamation-triangle" }
                ]
            },
            'dismiss': {
                text: `<p>You tell Riley everything is fine. Jordan notices your tension. "Who were you texting?" she demands. When you hesitate, her expression darkens. "It was Riley, wasn't it? They've never liked me!"</p>
                       <p>She moves closer. "You know they're just jealous of our relationship, right? Maybe you should distance yourself from them."</p>`,
                choices: [
                    { text: 'Agree to distance from Riley', next: 'distance-riley', effect: { selfWorth: -10, community: -20, safety: -5 }, icon: "fas fa-user-minus" },
                    { text: 'Defend Riley: "They\'re just concerned"', next: 'defend-riley', effect: { selfWorth: 5, community: 0, safety: -10 }, icon: "fas fa-shield-alt" },
                    { text: 'Change the subject quickly', next: 'change-subject', effect: { selfWorth: -5, community: -5, safety: 0 }, icon: "fas fa-exchange-alt" }
                ]
            },
            'confide': {
                text: `<p>You confide in Riley about Jordan's comments. They respond: "That's not okay. Your identity is valid. Do you want to talk to the group leader together?"</p>
                       <p>Just then, Jordan texts: "I got us tickets to that queer film festival! I know I've been stressed lately, but I love you and support you."</p>`,
                choices: [
                    { text: 'Accept the tickets and go with Jordan', next: 'accept-tickets', effect: { selfWorth: -5, community: -10, safety: -5 }, icon: "fas fa-ticket-alt" },
                    { text: 'Ask Jordan to talk about her behavior', next: 'address-behavior', effect: { selfWorth: 5, community: 0, safety: -5 }, icon: "fas fa-comment-medical" },
                    { text: 'Ask Riley to come over now', next: 'riley-over', effect: { selfWorth: 10, community: 15, safety: 10 }, icon: "fas fa-user-friends" }
                ]
            },
            'confront': {
                text: `<p>You confront Jordan about her comments. She immediately becomes defensive. "I can't believe you're attacking me! After everything I've done to support you?"</p>
                       <p>Her voice rises: "Maybe if you weren't so sensitive about your identity, we wouldn't have these problems!" Then she softens: "I'm sorry... I just worry people will judge you."</p>`,
                choices: [
                    { text: 'Accept her apology', next: 'accept-apology', effect: { selfWorth: -10, community: -5, safety: 0 }, icon: "fas fa-hand-holding-heart" },
                    { text: 'Insist she attend a support group with you', next: 'demand-support', effect: { selfWorth: 5, community: 5, safety: 0 }, icon: "fas fa-users" },
                    { text: 'Tell her you need space', next: 'need-space', effect: { selfWorth: 10, community: 5, safety: 5 }, icon: "fas fa-hourglass-half" }
                ]
            },
            
            // Dismiss path
            'defend-riley': {
                text: `<p>You defend Riley: "They're just concerned about me." Jordan scoffs. "Concerned? Or trying to break us up?" She steps closer. "I'm the one who truly understands you."</p>
                       <p>She places a hand on your arm. "Don't let outsiders poison what we have. Our love is special."</p>`,
                choices: [
                    { text: 'Agree to limit contact with Riley', next: 'limit-contact', effect: { selfWorth: -10, community: -15, safety: -5 }, icon: "fas fa-user-times" },
                    { text: 'Insist on maintaining your friendship', next: 'maintain-friendship', effect: { selfWorth: 10, community: 10, safety: -5 }, icon: "fas fa-user-friends" }
                ]
            },
            'change-subject': {
                text: `<p>You quickly change the subject. Jordan seems suspicious but lets it go. The next day, she "accidentally" breaks your phone. "I'll get you a new one," she says. "But maybe don't reinstall social media? It's toxic."</p>
                       <p>When you protest, she adds: "Besides, I want us to be more present with each other."</p>`,
                choices: [
                    { text: 'Agree to stay off social media', next: 'off-social', effect: { selfWorth: -10, community: -20, safety: -5 }, icon: "fas fa-mobile-alt" },
                    { text: 'Insist on having access to your community', next: 'access-community', effect: { selfWorth: 10, community: 15, safety: 0 }, icon: "fas fa-users" }
                ]
            },
            
            // Confide path
            'address-behavior': {
                text: `<p>You ask Jordan to talk about her behavior. She sighs dramatically. "Again? I already apologized! Why are you so obsessed with this?"</p>
                       <p>She crosses her arms. "If you keep bringing this up, maybe we should take a break. I can't be with someone who doesn't trust me."</p>`,
                choices: [
                    { text: 'Apologize and drop the subject', next: 'apologize-drop', effect: { selfWorth: -15, community: -10, safety: -5 }, icon: "fas fa-dove" },
                    { text: 'Stand firm: "This is important to me"', next: 'stand-firm', effect: { selfWorth: 10, community: 5, safety: 0 }, icon: "fas fa-gavel" }
                ]
            },
            
            // Confront path
            'accept-apology': {
                text: `<p>You accept Jordan's apology. She smiles. "Good. Now let's move forward." The next week, she insists on choosing your outfit for a family dinner. "My parents are traditional. Just wear this dress, okay? For me?"</p>
                       <p>When you hesitate, she adds: "Don't you want them to like you? It's just one night."</p>`,
                choices: [
                    { text: 'Agree to wear the dress', next: 'wear-dress', effect: { selfWorth: -15, community: -10, safety: -5 }, icon: "fas fa-tshirt" },
                    { text: 'Refuse: "This is who I am"', next: 'refuse-dress', effect: { selfWorth: 15, community: 10, safety: -5 }, icon: "fas fa-user" }
                ]
            },
            'need-space': {
                text: `<p>You tell Jordan you need space. She looks devastated. "Space? After everything I've done for you?" Tears fill her eyes. "I thought we were building something special."</p>
                       <p>She grabs your hand. "Please don't do this. I'll change! I'll go to therapy! Just give me another chance."</p>`,
                choices: [
                    { text: 'Give her another chance', next: 'another-chance', effect: { selfWorth: -5, community: 0, safety: 0 }, icon: "fas fa-redo" },
                    { text: 'Maintain your boundaries', next: 'maintain-boundaries', effect: { selfWorth: 15, community: 10, safety: 10 }, icon: "fas fa-border-style" }
                ]
            },
            
            // Distance Riley path
            'distance-riley': {
                text: `<p>You agree to distance yourself from Riley. Jordan seems pleased. Over the next week, she suggests skipping youth group meetings: "They're so dramatic anyway. We don't need that negativity."</p>
                       <p>When you mention wanting to attend Pride next month, Jordan scoffs: "Why do we need to go? Our relationship is private. Besides, my parents might see us."</p>`,
                choices: [
                    { text: 'Agree to skip Pride', next: 'skip-pride', effect: { selfWorth: -15, community: -20, safety: -5 }, icon: "fas fa-ban" },
                    { text: 'Insist on attending Pride', next: 'insist-pride', effect: { selfWorth: 5, community: 10, safety: -10 }, icon: "fas fa-rainbow" },
                    { text: 'Plan to go without Jordan', next: 'pride-alone', effect: { selfWorth: 10, community: 15, safety: 0 }, icon: "fas fa-walking" }
                ]
            },
            
            // Accept tickets path
            'accept-tickets': {
                text: `<p>At the film festival, Jordan criticizes your outfit: "Are you wearing that? It makes you look... confusing." When you express hurt, she gaslights you: "I'm just trying to help! Why are you so sensitive?"</p>
                       <p>Later, she points to a non-binary character: "See? They're just seeking attention. Unlike you - you're valid." The backhanded compliment stings.</p>`,
                choices: [
                    { text: 'Confront her about the comments', next: 'festival-confront', effect: { selfWorth: 0, community: 0, safety: -10 }, icon: "fas fa-comment-exclamation" },
                    { text: 'Excuse yourself to the bathroom', next: 'bathroom-break', effect: { selfWorth: -5, community: 0, safety: 5 }, icon: "fas fa-restroom" },
                    { text: 'Text Riley for support', next: 'text-riley', effect: { selfWorth: 5, community: 10, safety: 5 }, icon: "fas fa-comment-dots" }
                ]
            },
            
            // Riley over path
            'riley-over': {
                text: `<p>Riley comes over. Jordan arrives unexpectedly, her expression darkening when she sees Riley. "What are they doing here? I thought we were spending time together!"</p>
                       <p>Riley stands firm: "Han needed support after your comments at group." Jordan turns to you: "You're talking about me behind my back? After I got us festival tickets?"</p>`,
                choices: [
                    { text: 'Ask Riley to leave to calm Jordan', next: 'ask-riley-leave', effect: { selfWorth: -15, community: -20, safety: -10 }, icon: "fas fa-door-open" },
                    { text: 'Stand with Riley: "I needed support"', next: 'stand-with-riley', effect: { selfWorth: 10, community: 15, safety: 5 }, icon: "fas fa-users" },
                    { text: 'Suggest Jordan join the conversation', next: 'group-talk', effect: { selfWorth: 0, community: 5, safety: 0 }, icon: "fas fa-comments" }
                ]
            },
            
            // Demand support path
            'demand-support': {
                text: `<p>You insist Jordan attend a support group. She reluctantly agrees but spends the session criticizing others. Afterward: "See? This is why I hate these groups. Everyone's so obsessed with labels!"</p>
                       <p>She gives you an ultimatum: "It's me or this group. I can't be with someone who prioritizes strangers over our relationship."</p>`,
                choices: [
                    { text: 'Choose Jordan and leave the group', next: 'ending-isolation', effect: { selfWorth: -20, community: -30, safety: -10 }, icon: "fas fa-user-minus" },
                    { text: 'Refuse the ultimatum', next: 'refuse-ultimatum', effect: { selfWorth: 15, community: 20, safety: 5 }, icon: "fas fa-ban" },
                    { text: 'Ask the group leader for help', next: 'leader-help', effect: { selfWorth: 10, community: 25, safety: 10 }, icon: "fas fa-hands-helping" }
                ]
            },
            
            // Stand with Riley path
            'stand-with-riley': {
                text: `<p>You stand with Riley. Jordan explodes: "Fine! If you choose them over me, we're done!" She storms out. Riley hugs you: "I'm proud of you."</p>
                       <p>Two days later, Jordan returns crying: "I'm sorry! I've been struggling with internalized biphobia. I'll get therapy. Please give me another chance."</p>`,
                choices: [
                    { text: 'Give her another chance with conditions', next: 'conditional-chance', effect: { selfWorth: 5, community: 0, safety: 0 }, icon: "fas fa-redo" },
                    { text: 'Maintain your boundaries', next: 'ending-boundaries', effect: { selfWorth: 20, community: 25, safety: 15 }, icon: "fas fa-gavel" },
                    { text: 'Suggest a break while she seeks help', next: 'temporary-break', effect: { selfWorth: 15, community: 20, safety: 10 }, icon: "fas fa-pause-circle" }
                ]
            },
            
            // ENDINGS
            'ending-isolation': {
                title: 'Lost in the Shadows',
                icon: 'fas fa-user-slash',
                text: `<p>You choose Jordan over your community. Gradually, you lose touch with Riley and stop attending youth group. Jordan's criticism escalates, chipping away at your self-esteem.</p>
                       <p>You start presenting more feminine to please her, suppressing your true identity. The person in the mirror feels like a stranger, but Jordan approves. You've become isolated, dependent solely on a relationship that diminishes you.</p>
                       <div class="ending-tag">Ending: Identity Suppressed</div>`,
                ending: true
            },
            'ending-boundaries': {
                title: 'Rainbow Resilience',
                icon: 'fas fa-rainbow',
                text: `<p>You maintain your boundaries. Jordan reluctantly enters therapy to address her internalized biphobia. With your youth group's support, you establish clear expectations.</p>
                       <p>Over time, Jordan makes genuine progress. She apologizes authentically and becomes an advocate. Your relationship transforms into one of mutual respect where your identity is celebrated.</p>
                       <div class="ending-tag">Ending: Healthy Transformation</div>`,
                ending: true
            },
            'ending-empowerment': {
                title: 'Authentic Self',
                icon: 'fas fa-user-astronaut',
                text: `<p>With Riley's support, you leave the relationship. At first it's painful, but with therapy and community support, you rediscover your confidence.</p>
                       <p>You become active in LGBTQIA+ advocacy, helping others recognize toxic patterns. A year later, you're thriving - your identity celebrated, your boundaries respected.</p>
                       <div class="ending-tag">Ending: Self-Discovery</div>`,
                ending: true
            },
            'ending-community': {
                title: 'Chosen Family',
                icon: 'fas fa-users',
                text: `<p>Your youth group surrounds you with support. Jordan's attempts to isolate you fail as the community holds her accountable. She enters a specialized program for internalized homophobia.</p>
                       <p>Regardless of Jordan's journey, you build deep connections. You learn that love shouldn't require compromising your identity. Your chosen family helps you heal and grow.</p>
                       <div class="ending-tag">Ending: Community Strength</div>`,
                ending: true
            },
            'ending-compromise': {
                title: 'Fragile Balance',
                icon: 'fas fa-balance-scale',
                text: `<p>You find a fragile balance. Jordan makes small efforts to improve, though she occasionally slips back into old patterns. You maintain connections with Riley and your community.</p>
                       <p>The relationship remains challenging, but you've established boundaries that protect your identity. You stay vigilant, knowing your self-worth must come first.</p>
                       <div class="ending-tag">Ending: Conditional Progress</div>`,
                ending: true
            },
            'ending-liberation': {
                title: 'True Liberation',
                icon: 'fas fa-dove',
                text: `<p>You break free from the relationship and immerse yourself in community. Through therapy and support groups, you unpack the emotional manipulation and reclaim your identity.</p>
                       <p>A year later, you're leading workshops at the youth center, helping others recognize toxic patterns. You've found peace in your authentic self, surrounded by people who celebrate you.</p>
                       <div class="ending-tag">Ending: Authentic Freedom</div>`,
                ending: true
            },
            
            // Path completions
            'limit-contact': {
                text: `<p>You agree to limit contact with Riley. Jordan monitors your communications and isolates you further. When you express loneliness, she says: "You have me. Isn't that enough?"</p>
                       <p>Over time, you lose touch with your identity and community, becoming completely dependent on Jordan's approval.</p>`,
                next: 'ending-isolation',
                ending: true
            },
            'maintain-friendship': {
                text: `<p>You insist on maintaining your friendship with Riley. Jordan becomes increasingly controlling and critical. When you attend a community event without her, she accuses you of cheating.</p>
                       <p>With Riley's support, you realize the relationship is harming your mental health and decide to end it.</p>`,
                next: 'ending-empowerment',
                ending: true
            },
            'off-social': {
                text: `<p>You agree to stay off social media. Jordan isolates you completely from your community. She controls what you wear and how you present, claiming it's "for your own good."</p>
                       <p>You become a shell of yourself, suppressing your identity to maintain peace in the relationship.</p>`,
                next: 'ending-isolation',
                ending: true
            },
            'access-community': {
                text: `<p>You insist on maintaining access to your community. Jordan becomes hostile and threatens to break up. With support from your youth group, you realize this isn't love.</p>
                       <p>You end the relationship and immerse yourself in community healing spaces.</p>`,
                next: 'ending-community',
                ending: true
            },
            'apologize-drop': {
                text: `<p>You apologize and drop the subject. Jordan's behavior continues, and she escalates her criticism of your identity. Each confrontation follows the same pattern: criticism, gaslighting, and false apologies.</p>
                       <p>You feel trapped, unable to express your needs without facing Jordan's anger.</p>`,
                next: 'ending-isolation',
                ending: true
            },
            'stand-firm': {
                text: `<p>You stand firm: "This is important to me." Jordan storms out. The next day, she sends a long apology and agrees to attend therapy.</p>
                       <p>With professional help, Jordan addresses her internalized biphobia. Your relationship slowly transforms into a healthier dynamic.</p>`,
                next: 'ending-boundaries',
                ending: true
            },
            'wear-dress': {
                text: `<p>You wear the dress to please Jordan. At dinner, her parents misgender you repeatedly. Jordan does nothing to correct them. Afterward, she says: "See? This is why I wanted you to dress normally."</p>
                       <p>You feel your identity being erased in the relationship.</p>`,
                next: 'ending-isolation',
                ending: true
            },
            'refuse-dress': {
                text: `<p>You refuse: "This is who I am." Jordan is furious. "You're embarrassing me! After everything I've done for you!" She breaks up with you on the spot.</p>
                       <p>Initially painful, this becomes a turning point. You reconnect with your community and discover new strength in your identity.</p>`,
                next: 'ending-liberation',
                ending: true
            },
            'another-chance': {
                text: `<p>You give Jordan another chance. She attends one therapy session but quits, saying: "The therapist doesn't understand me." Her behavior worsens.</p>
                       <p>When you try to leave again, she threatens self-harm. You feel trapped in a cycle of manipulation.</p>`,
                next: 'ending-isolation',
                ending: true
            },
            'maintain-boundaries': {
                text: `<p>You maintain your boundaries. Jordan initially resists but eventually respects your need for space. During this time, you reconnect with your community.</p>
                       <p>With support, you realize the relationship was toxic. You end things and focus on your healing journey.</p>`,
                next: 'ending-liberation',
                ending: true
            },
            'skip-pride': {
                text: `<p>You skip Pride to please Jordan. She isolates you further from the community. When you express missing your friends, she says: "I'm your family now. You don't need anyone else."</p>
                       <p>Over time, you lose your sense of self and identity.</p>`,
                next: 'ending-isolation',
                ending: true
            },
            'insist-pride': {
                text: `<p>You insist on attending Pride. Jordan reluctantly comes but criticizes everything. When you run into Riley, Jordan makes a scene. "You planned this!" she accuses.</p>
                       <p>At that moment, you realize the relationship is beyond repair. You leave with Riley and never look back.</p>`,
                next: 'ending-liberation',
                ending: true
            },
            'pride-alone': {
                text: `<p>You attend Pride without Jordan. Surrounded by community, you feel your authentic self reawakening. Riley introduces you to supportive friends who celebrate your identity.</p>
                       <p>You realize a relationship shouldn't require sacrificing your community. You end things with Jordan and embrace your chosen family.</p>`,
                next: 'ending-community',
                ending: true
            },
            'festival-confront': {
                text: `<p>You confront Jordan about her comments. She gaslights you: "I was complimenting you! Why do you always twist things?" She storms out, leaving you stranded.</p>
                       <p>Riley picks you up. With their support, you realize this pattern won't change. You end the relationship.</p>`,
                next: 'ending-liberation',
                ending: true
            },
            'bathroom-break': {
                text: `<p>In the bathroom, you text Riley: "I need help." They respond: "I'm coming." When Riley arrives, Jordan becomes hostile. "You called them? After I bought these tickets?"</p>
                       <p>Seeing Jordan's true colors, you leave with Riley. This becomes the first step in reclaiming your identity.</p>`,
                next: 'ending-liberation',
                ending: true
            },
            'text-riley': {
                text: `<p>You text Riley for support. They respond: "Hold on, I'm coming." When Riley arrives, they confront Jordan about her behavior. Jordan tries to manipulate the situation.</p>
                       <p>Seeing this, you realize Jordan won't change. You leave with Riley and begin your healing journey.</p>`,
                next: 'ending-empowerment',
                ending: true
            },
            'ask-riley-leave': {
                text: `<p>You ask Riley to leave. Jordan seems satisfied but becomes more controlling. "See? You chose me." She isolates you further from your community.</p>
                       <p>Without support, you lose confidence in your identity. Jordan dictates how you present and who you see.</p>`,
                next: 'ending-isolation',
                ending: true
            },
            'group-talk': {
                text: `<p>You suggest Jordan join the conversation. She reluctantly agrees but dominates the discussion. "Riley's been poisoning you against me," she claims.</p>
                       <p>Riley remains calm and supportive. Seeing Jordan's manipulation clearly, you end the relationship.</p>`,
                next: 'ending-liberation',
                ending: true
            },
            'refuse-ultimatum': {
                text: `<p>You refuse the ultimatum. Jordan breaks up with you dramatically. Initially heartbroken, you immerse yourself in community.</p>
                       <p>With support, you heal and discover relationships shouldn't require abandoning your identity. You thrive as your authentic self.</p>`,
                next: 'ending-liberation',
                ending: true
            },
            'leader-help': {
                text: `<p>You ask the group leader for help. They connect you with resources for partners struggling with internalized homophobia. Jordan reluctantly agrees to attend.</p>
                       <p>With professional guidance, Jordan confronts her biases. Your relationship transforms into a healthier dynamic over time.</p>`,
                next: 'ending-boundaries',
                ending: true
            },
            'conditional-chance': {
                text: `<p>You give Jordan a conditional chance: therapy and accountability. She makes surface-level changes but resists deeper work. When you raise concerns, she says: "I'm trying! Why can't you be happy?"</p>
                       <p>The relationship remains unstable, with Jordan periodically reverting to old patterns.</p>`,
                next: 'ending-compromise',
                ending: true
            },
            'temporary-break': {
                text: `<p>You suggest a break while Jordan seeks help. She reluctantly agrees. During this time, you reconnect with community and rediscover your strength.</p>
                       <p>When Jordan returns, you realize you've outgrown the relationship. You end things peacefully and focus on your growth.</p>`,
                next: 'ending-liberation',
                ending: true
            }
        };
        
        // Initialize game
        function initGame() {
            updateStats();
            createPrideFlags();
            renderScene('start');
        }
        
        // Render scene
        function renderScene(sceneId) {
            const scene = scenes[sceneId];
            const gameArea = document.getElementById('gameArea');
            gameState.currentScene = sceneId;
            gameState.progress = sceneId === 'start' ? 0 : Math.min(gameState.progress + 15, 100);
            
            if (scene.ending) {
                if (scene.next) {
                    // If scene has a next property, render that ending
                    renderScene(scene.next);
                    return;
                }
                
                gameArea.innerHTML = `
                    <div class="ending-screen fade-in">
                        <div class="ending-icon"><i class="${scene.icon}"></i></div>
                        <h2 class="ending-title">${scene.title}</h2>
                        <div class="ending-description">${scene.text}</div>
                        <button class="restart-btn" onclick="restartGame()"><i class="fas fa-redo"></i> Play Again</button>
                    </div>
                `;
            } else {
                let choicesHTML = '';
                scene.choices.forEach(choice => {
                    choicesHTML += `
                        <button class="choice-btn" data-next="${choice.next}">
                            <i class="${choice.icon}"></i> ${choice.text}
                        </button>
                    `;
                });
                
                gameArea.innerHTML = `
                    <div class="scene fade-in">
                        <div class="scene-text">${scene.text}</div>
                        <div class="choices">${choicesHTML}</div>
                    </div>
                `;
                
                // Add event listeners to new choice buttons
                document.querySelectorAll('.choice-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const nextScene = this.getAttribute('data-next');
                        const choiceEffect = scene.choices.find(c => c.next === nextScene)?.effect;
                        
                        if (choiceEffect) {
                            gameState.selfWorth = Math.max(0, Math.min(100, gameState.selfWorth + choiceEffect.selfWorth));
                            gameState.community = Math.max(0, Math.min(100, gameState.community + choiceEffect.community));
                            gameState.safety = Math.max(0, Math.min(100, gameState.safety + choiceEffect.safety));
                            updateStats();
                        }
                        
                        // Special scene handling
                        if (nextScene === 'skip-pride') {
                            gameState.isolated = true;
                        }
                        if (nextScene === 'festival-confront') {
                            gameState.identityQuestioned = true;
                        }
                        
                        // Check for ending conditions
                        if (gameState.selfWorth <= 20) {
                            renderScene('ending-isolation');
                        } else if (gameState.selfWorth >= 80 && gameState.community >= 70) {
                            renderScene('ending-liberation');
                        } else {
                            renderScene(nextScene);
                        }
                    });
                });
            }
            
            updateStats();
        }
        
        // Restart game
        function restartGame() {
            gameState.selfWorth = 50;
            gameState.community = 70;
            gameState.safety = 60;
            gameState.progress = 0;
            gameState.identityQuestioned = false;
            gameState.isolated = false;
            renderScene('start');
        }
        
        // Create decorative pride flags
        function createPrideFlags() {
            const body = document.querySelector('body');
            const flagColors = [
                ['#e40303', '#ff8c00', '#ffed00', '#008026', '#004dff', '#750787'], // Traditional Pride
                ['#5bcefa', '#f5a9b8', '#ffffff', '#f5a9b8', '#5bcefa'], // Trans Pride
                ['#d60270', '#d60270', '#9b4f96', '#0038a8', '#0038a8'], // Bi Pride
                ['#078d70', '#98e8c1', '#ffffff', '#7bade2', '#3d1a78'] // Non-binary Pride
            ];
            
            for (let i = 0; i < 12; i++) {
                const flag = document.createElement('div');
                flag.classList.add('pride-flag');
                
                const size = Math.random() * 40 + 30;
                const posX = Math.random() * 100;
                const posY = Math.random() * 100;
                const duration = Math.random() * 20 + 20;
                const delay = Math.random() * 5;
                const flagType = Math.floor(Math.random() * flagColors.length);
                
                flag.style.width = `${size}px`;
                flag.style.height = `${size * 3}px`;
                flag.style.left = `${posX}%`;
                flag.style.top = `${posY}%`;
                flag.style.animationDuration = `${duration}s`;
                flag.style.animationDelay = `${delay}s`;
                
                // Create flag stripes
                const colors = flagColors[flagType];
                for (let j = 0; j < colors.length; j++) {
                    const stripe = document.createElement('div');
                    stripe.style.backgroundColor = colors[j];
                    stripe.style.height = `${100/colors.length}%`;
                    stripe.style.top = `${(j * 100)/colors.length}%`;
                    stripe.style.position = 'absolute';
                    stripe.style.width = '100%';
                    flag.appendChild(stripe);
                }
                
                body.appendChild(flag);
            }
        }
        
        // Initialize the game when page loads
        window.onload = initGame;
    </script>
</body>
</html>